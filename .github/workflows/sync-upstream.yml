name: Sync with upstream repository

on:
    schedule:
        # Run this workflow daily at midnight
        - cron: '0 0 * * *'
    workflow_dispatch: # Allow manual triggering

jobs:
    sync:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
              with:
                  fetch-depth: 0

            - name: Configure Git
              run: |
                  git config user.name github-actions
                  git config user.email github-actions@github.com

            - name: Add upstream remote
              run: |
                  git remote add upstream https://github.com/killergerbah/asbplayer.git || true

            - name: Fetch upstream changes
              run: |
                  git fetch upstream

            - name: Rebase on upstream changes
              run: |
                  git checkout main
                  git rebase upstream/main

            - name: Push changes to origin
              run: |
                  git push --force-with-lease origin main
